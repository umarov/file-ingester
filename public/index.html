<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Ingester</title>
  </head>

  <body>
    <h1>File Ingester</h1>

    <main>
      <input type="file" id="input">
    </main>
  </body>

  <script>
    const inputElement = document.getElementById("input");
    inputElement.addEventListener("change", handleFiles, false);
    async function handleFiles() {
      const file = this.files[0]; /* now you can work with the file list */

      const formData = new FormData()
      formData.append('csv', file)

      try {
        const results = await Promise.all([
          fetch('/', {
            method: 'POST',
            body: formData
          }).then(res => res.json()),
          fetch('/', {
            method: 'POST',
            body: formData
          }).then(res => res.json()),
          fetch('/', {
            method: 'POST',
            body: formData
          }).then(res => res.json())
        ])

        console.log(results);
      } catch (err) {
        console.log(err);
      }

    }
  </script>
</html>
